---
import Layout from '../../../layouts/Layout.astro'
---

	<script src="/static/jquery.js" is:inline></script>
  <script src="https://code.responsivevoice.org/responsivevoice.js?key=3Wzpm5HU" is:inline></script>
<style>
.box-model{
			width: 100%;
			margin: 0;
			background: rgb(26, 2, 94);
			min-height: 100vh;
			display: flex;
			flex-direction: column;
			align-items: center;
		}

		.game_card{
			width: 450px;
			margin: 30px 5%;
			height: 80%;
			background-color: white;
			border-radius: 30px;
			display: flex;
			flex-direction: column;
			justify-content: flex-start;
			align-items: center;
			padding: 5px 2px 30px 2px;
		}

		.top{
			width: 100%;
			display: flex;
			align-items: center;
			margin: 20px 0;
			flex-direction: column;
			text-align: center;
		}

		.img_container{
			width: 90%;
			margin: 20px 5%;
			border-top-left-radius: 60px;
			border-top-right-radius: 60px;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			height: 70%;
		}


		.btn-left{
			border-radius: 30px;
			padding: 6px 20px;
			position: absolute;
                        margin-top:30px;
			bottom: 10px;
			left: 30px;
			
		}

		.btn-right{
			border-radius: 30px;
			padding: 6px 20px;
                        margin-top:30px;
			position: absolute;
			bottom: 10px;
			right: 30px;
			
		}


		.btn-right:hover, .btn-left:hover{
			box-shadow: 0 0 8px 2px rgb(110, 78, 255);
		}

		.divider{
			height: 2px;
			width: 40%;
			background:gray;
		}

		#answer{
     width: 70%;
     padding: 10px 10px;     
     border-right:none ;
     border-top-left-radius:30px ;
     border-bottom-left-radius:30px ;
     outline: none;
		}

		

		#check{
			width: 20%;
			padding: 8px 20px;
			border-top-right-radius:30px ;
     border-bottom-right-radius:30px ;

		}


		.progress{
			width: 250px;
			border-radius: 150px;
			height: 20px;
			display: flex;
			padding: 0 5px;
			justify-content: left;
			align-items: center;
		}

		.progress_bar{
			width: 100%;
			border-radius: 150px;
			place-items: center;
			height: 10px;
			background: #21eb75;
		}

		@media screen and (max-width:660px){
			.game_card{
			width: 90%;
			margin: 30px 5%;
			height: 70%;
			background-color: white;
			border-radius: 30px;
			padding: 5px 2px 30px 2px;
			display: flex;
			flex-direction: column;
			justify-content: flex-start;
			align-items: center;
		}
          	.btn-left{
			display:none;			
		}

		.btn-right{
			display:none;
		}
	}
		
</style>
<Layout title="Quiz Card">
<main class="box-model" id="quiz_page">
	<div class="top">
   <div class="progress bg-gray-800 border-2 border-gray-700">
	<div class="progress_bar"></div>
</div>
<div id="idNum" class="text-lg text-white"></div>
	</div>
<h3 id="cue" class="hidden"></h3>


<div class="game_card">
	<div class="img_container bg-blue-300">
		<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-13 h-13 text-blue-700">
  <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm11.378-3.917c-.89-.777-2.366-.777-3.255 0a.75.75 0 01-.988-1.129c1.454-1.272 3.776-1.272 5.23 0 1.513 1.324 1.513 3.518 0 4.842a3.75 3.75 0 01-.837.552c-.676.328-1.028.774-1.028 1.152v.75a.75.75 0 01-1.5 0v-.75c0-1.279 1.06-2.107 1.875-2.502.182-.088.351-.199.503-.331.83-.727.83-1.857 0-2.584zM12 18a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd" />
</svg>
	</div>
	<p id="tr" class="text-2xl my-2 text-gray-600 capitalize"></p>
	<div class="w-full flex justify-center items-center">
		<input id="answer" type="text" name="" class="border-2 border-gray-200" placeholder="Your answer">
		<button id="check" class="bg-blue-700">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-white">
  <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
</svg>

		</button>
	</div>
</div>
<div class="flex mt-5  justify-around items-center w-full">
  <button class="btn-left hidden transparent hover:bg-gray-700 border-2 border-gray-700" id="prev">
  	<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-gray-400 hover:text-indigo-400">
  <path fill-rule="evenodd" d="M13.28 3.97a.75.75 0 010 1.06L6.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5a.75.75 0 010-1.06l7.5-7.5a.75.75 0 011.06 0zm6 0a.75.75 0 010 1.06L12.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5a.75.75 0 010-1.06l7.5-7.5a.75.75 0 011.06 0z" clip-rule="evenodd" />
</svg>

  </button>



  <button class="btn-right  transparent hover:bg-gray-700 border-2 border-gray-700"  id="next">
  	<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-gray-400 hover:text-indigo-400">
  <path fill-rule="evenodd" d="M4.72 3.97a.75.75 0 011.06 0l7.5 7.5a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L11.69 12 4.72 5.03a.75.75 0 010-1.06zm6 0a.75.75 0 011.06 0l7.5 7.5a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 11-1.06-1.06L17.69 12l-6.97-6.97a.75.75 0 010-1.06z" clip-rule="evenodd" />
</svg>

</button>
  <button class="hidden btn-right  text-green-400 transparent hover:bg-gray-700 border-2 border-gray-700" id="result">View Result</button>

</div>  
</main>	 

<section class="flex flex-col bg-blue-900 min-h-screen w-full hidden" id="result_page">
	<ol class="container mx-auto px-4 my-3" id="your-answers"></ol>
</section>
</Layout>
<script is:inline>
//Game functions
let currentFlashcard=0

const id = new URLSearchParams(window.location.search).get("id");

  const renderdetails= async ()=>{
    const res= await fetch('https://server-five-dusky.vercel.app/games/'+ id);
    var flashcards= await res.json();

    var progress_val=100/flashcards.words.length
let progress=progress_val;
$("#idNum").html(`${currentFlashcard+1}/${flashcards.words.length+1}`)
$(".progress_bar").width(progress+"%")

 $("#check").click(function(){
  $("#check").attr("disabled","true")
	const taken=$("#answer").val().replace(/\s|-|'/g, "")
const TypedValue=taken.toLowerCase()
  const correctTranslation = flashcards.words[currentFlashcard].word.replace(/\s|-|'/g, "");
  if (TypedValue===correctTranslation) {
    $(".img_container").html(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-13 h-13 text-green-500">
  <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
</svg>
`)
    $(".img_container").removeClass("bg-red-300")
    $(".img_container").addClass("bg-green-300")
    setTimeout(nextWord, 1500)
		var wordValue=flashcards.words[currentFlashcard].word
    const voiceName = "UK English Male";
    responsiveVoice.speak(wordValue, voiceName);
      // Add true answer to the list
    $("#your-answers").append(`<li class="bg-gray-800 py-3 px-5 w-full my-2 text-green-400">${flashcards.words[currentFlashcard].word} - ${flashcards.words[currentFlashcard].translation}</li>`);
  
}
else{
    setTimeout(nextWord, 1500)
    $(".img_container").html(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-13 h-13 text-rose-600">
  <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z" clip-rule="evenodd" />
</svg>

`)
    $(".img_container").removeClass("bg-green-300")
    $(".img_container").removeClass("bg-blue-300")
    $(".img_container").addClass("bg-red-300")
  // Add false answer to the list
    $("#your-answers").append(`<li class="bg-gray-800 py-3 px-5 w-full my-2 text-red-400">${flashcards.words[currentFlashcard].word} - ${flashcards.words[currentFlashcard].translation}</li>`);
    var wordValue=flashcards.words[currentFlashcard].word
    const voiceName = "UK English Male";
    responsiveVoice.speak(wordValue, voiceName);
}

});
 

 //Next word

$("#next").click(function(){
  if($("#answer").val()===""){
  $(".img_container").html(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-13 h-13 text-rose-600">
  <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z" clip-rule="evenodd" />
</svg>

`)
    $(".img_container").removeClass("bg-green-300")
    $(".img_container").removeClass("bg-blue-300")
    $(".img_container").addClass("bg-red-300")
  // Add false answer to the list
    $("#your-answers").append(`<li class="bg-gray-800 py-3 px-5 w-full my-2 text-red-400">${flashcards.words[currentFlashcard].word} - ${flashcards.words[currentFlashcard].translation}</li>`);

}

$("#check").removeAttr("disabled")
$("#answer").val('')
    currentFlashcard++
    progress+=progress_val
    $("#idNum").html(`${currentFlashcard+1}/${flashcards.words.length+1}`)
    $("#tr").html(flashcards.words[currentFlashcard].translation)
     $(".img_container").html(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-13 h-13 text-blue-700">
  <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm11.378-3.917c-.89-.777-2.366-.777-3.255 0a.75.75 0 01-.988-1.129c1.454-1.272 3.776-1.272 5.23 0 1.513 1.324 1.513 3.518 0 4.842a3.75 3.75 0 01-.837.552c-.676.328-1.028.774-1.028 1.152v.75a.75.75 0 01-1.5 0v-.75c0-1.279 1.06-2.107 1.875-2.502.182-.088.351-.199.503-.331.83-.727.83-1.857 0-2.584zM12 18a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd" />
</svg>

`)
    $(".img_container").removeClass("bg-green-300")
    $(".img_container").removeClass("bg-red-300")
    $(".img_container").addClass("bg-blue-300")
    $(".progress_bar").width(progress+"%")
    $("#prev").removeClass("hidden")
    if(currentFlashcard===flashcards.words.length-1){
      $("#next").hide()
      $("#result").show()
    }
    
  });

  
  $("#prev").click(function(){
    $("#check").removeAttr("disabled")
    currentFlashcard--
    $("#answer").val('')
    progress-=progress_val
    $(".progress_bar").width(progress+"%")
    $("#tr").html(flashcards.words[currentFlashcard].translation) 
    $("#next").show()
    $("#result").hide()
    if(currentFlashcard===0){
      $("#prev").hide()
      
    }       
    
  })



//Next Function
function nextWord(){
  $("#check").removeAttr("disabled")
$("#answer").val('')
    currentFlashcard++
    progress+=progress_val
    $("#idNum").html(`${currentFlashcard+1}/${flashcards.words.length+1}`)
    $("#tr").html(flashcards.words[currentFlashcard].translation)
     $(".img_container").html(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-13 h-13 text-blue-700">
  <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm11.378-3.917c-.89-.777-2.366-.777-3.255 0a.75.75 0 01-.988-1.129c1.454-1.272 3.776-1.272 5.23 0 1.513 1.324 1.513 3.518 0 4.842a3.75 3.75 0 01-.837.552c-.676.328-1.028.774-1.028 1.152v.75a.75.75 0 01-1.5 0v-.75c0-1.279 1.06-2.107 1.875-2.502.182-.088.351-.199.503-.331.83-.727.83-1.857 0-2.584zM12 18a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd" />
</svg>

`)
    $(".img_container").removeClass("bg-green-300")
    $(".img_container").removeClass("bg-red-300")
    $(".img_container").addClass("bg-blue-300")
    $(".progress_bar").width(progress+"%")
    if(currentFlashcard===flashcards.words.length-1){
      $("#next").hide()
      $("#result").show()
    }
}    

  //Intialize

$(document).ready(function(){
  $("#cue").html(flashcards.words[currentFlashcard].word)
$("#tr").html(flashcards.words[currentFlashcard].translation)

})
	

$("#result").click(()=>{
  $(".box-model").hide()
  $("#result_page").removeClass("hidden")
})



}

window.addEventListener("DOMContentLoaded", ()=> renderdetails())
</script>




   <script is:inline>
   	$(".btn-right").click(()=>{
   		$(".btn-right").css("transform", "scale(0.9)")
   		setTimeout(()=>{
   		$(".btn-right").css("transform", "scale(1.0)")	
   		},220)
   	})

   	$(".btn-left").click(()=>{
   		$(".btn-left").css("transform", "scale(0.9)")
   		setTimeout(()=>{
   		$(".btn-left").css("transform", "scale(1.0)")	
   		},220)
   	})
   </script>
